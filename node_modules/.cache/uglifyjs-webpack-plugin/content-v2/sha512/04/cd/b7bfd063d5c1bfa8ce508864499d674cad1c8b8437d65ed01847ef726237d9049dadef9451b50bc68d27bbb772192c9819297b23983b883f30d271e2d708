{"code":"!function(t){var s={};function i(e){if(s[e])return s[e].exports;var r=s[e]={i:e,l:!1,exports:{}};return t[e].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=t,i.c=s,i.d=function(t,s,e){i.o(t,s)||Object.defineProperty(t,s,{enumerable:!0,get:e})},i.r=function(t){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(t,\"__esModule\",{value:!0})},i.t=function(t,s){if(1&s&&(t=i(t)),8&s)return t;if(4&s&&\"object\"==typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(i.r(e),Object.defineProperty(e,\"default\",{enumerable:!0,value:t}),2&s&&\"string\"!=typeof t)for(var r in t)i.d(e,r,function(s){return t[s]}.bind(null,r));return e},i.n=function(t){var s=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(s,\"a\",s),s},i.o=function(t,s){return Object.prototype.hasOwnProperty.call(t,s)},i.p=\"\",i(i.s=0)}([function(t,s,i){\"use strict\";function e(t,s){return{x:t.x+s.x,y:t.y+s.y}}function r(t){return Math.sqrt(t.x*t.x+t.y*t.y)}function h(t,s){return{x:t.x*Math.cos(s*Math.PI/180)-t.y*Math.sin(s*Math.PI/180),y:t.x*Math.sin(s*Math.PI/180)+t.y*Math.cos(s*Math.PI/180)}}function n(t,s){return{x:s*t.x,y:s*t.y}}function o(t,s,i,e){this.x=t,this.y=s,this.dir=i,this.v={x:e.x,y:e.y}}function a(t,s,i,e,r,h){return this.x=t,this.y=s,this.m=i,this.r=e,this.v={x:r,y:h},this}function u(t){var s=[],i=[],e=0;for(e=0;e<t;e++){for(var r=Math.floor(1200*Math.random()),h=Math.floor(700*Math.random());i.indexOf({x:r,y:h})>-1;)r=Math.floor(1200*Math.random()),h=Math.floor(700*Math.random());i.push({x:r,y:h});var n=Math.floor(20*Math.random())+10,o=.004*Math.random()+.001,u=.004*Math.random()+.001,c=new a(r,h,80*Math.pow(n/10,3)/3,n,o,u);s.push(c)}return s}function c(t){var s={x:t.x+20*Math.cos(t.dir*Math.PI/180),y:t.y+20*Math.sin(t.dir*Math.PI/180)};this.x=s.x,this.y=s.y,this.v=h({x:.3,y:0},t.dir)}function f(t,s){return[n(e(n(t.v,t.m-s.m),n(s.v,2*s.m)),1/(t.m+s.m)),n(e(n(s.v,s.m-t.m),n(t.v,2*s.m)),1/(t.m+s.m))]}function l(t){var s=h(t.v,90),i=h(t.v,270);return console.log(\"newAst\",[s,i]),[s,i]}function d(t,s){return Math.sqrt((t.x-s.x)*(t.x-s.x)+(t.y-s.y)*(t.y-s.y))<t.r+s.r}function y(t,s){return Math.sqrt((s.x-t.x)*(s.x-t.x)+(s.y-t.y)*(s.y-t.y))<s.r}function p(t,s){t.x,s.x,t.y,s.y;var i=1e3,e=180*function(t,s){return Math.acos(function(t,s){return t.x*s.x+t.y+s.y}(t,s)/(r(t)*r(s)))}(t,s)/Math.PI%120;return i=e<60?10/Math.cos((60-e)*Math.PI/180):e>60?10/Math.cos((e-60)*Math.PI/180):10,Math.sqrt((t.x-s.x)*(t.x-s.x)+(t.y-s.y)*(t.y-s.y))<t.r+i}i.r(s),o.prototype.update=function(t){this.x+=this.v.x*t,this.y+=this.v.y*t,this.x<0&&(this.x+=1200),this.y<0&&(this.y+=700),this.x=this.x%1200,this.y=this.y%700},o.prototype.render=function(t){var s={x:this.x+20*Math.cos(this.dir*Math.PI/180),y:this.y+20*Math.sin(this.dir*Math.PI/180)},i={x:this.x+20*Math.cos((this.dir+120)*Math.PI/180),y:this.y+20*Math.sin((this.dir+120)*Math.PI/180)},e={x:this.x+20*Math.cos((this.dir+240)*Math.PI/180),y:this.y+20*Math.sin((this.dir+240)*Math.PI/180)};t.beginPath(),t.moveTo(s.x,s.y),t.lineTo(i.x,i.y),t.lineTo(e.x,e.y),t.closePath(),t.fillStyle=\"red\",t.fill()},a.prototype.update=function(t){this.x+=this.v.x*t,this.y+=this.v.y*t,this.x<0&&(this.x+=1200),this.y<0&&(this.y+=700),this.x=this.x%1200,this.y=this.y%700},a.prototype.render=function(t){t.beginPath(),t.arc(this.x,this.y,this.r,0,2*Math.PI),t.fillStyle=\"white\",t.closePath(),t.fill()},c.prototype.update=function(t){this.x+=this.v.x*t,this.y+=this.v.y*t},c.prototype.render=function(t){var s=h({x:.5,y:0},90),i={x:this.x+s.x,y:this.y+s.y},e=h({x:.5,y:0},270),r={x:this.x+e.x,y:this.y+e.y},n=h({x:5,y:0},180);t.beginPath(),t.moveTo(i.x,i.y),t.lineTo(r.x,r.y),t.lineTo(r.x+n.x,r.y+n.y),t.lineTo(i.x+n.x,i.y+n.y),t.closePath(),t.fillStyle=\"pink\",t.fill()};var x=new class{constructor(t,s){this._start=null,this.WIDTH=t,this.HEIGHT=s,this.bullets=[],this.ship=new o(t/2,s/2,0,{x:0,y:0}),this.level=1,this.life=3,this.score=0,this.end=!1,this.asteroids=u(5+5*this.level),this.boom=new Audio(\"boom.mp3\"),this.laser=new Audio(\"laser.mp3\"),this.currentInput={space:!1,front:!1,left:!1,right:!1},this.priorInput={space:!1,front:!1,left:!1,right:!1},this.backBuffer=document.createElement(\"canvas\"),this.backBuffer.width=this.WIDTH,this.backBuffer.height=this.HEIGHT,this.backBufferCtx=this.backBuffer.getContext(\"2d\"),this.screenBuffer=document.createElement(\"canvas\"),this.screenBuffer.width=this.WIDTH,this.screenBuffer.height=this.HEIGHT,this.screenBufferCtx=this.screenBuffer.getContext(\"2d\"),document.body.append(this.screenBuffer)}update(t){this.currentInput.space&&!this.priorInput.space&&(this.bullets.push(new c(this.ship)),this.laser.play()),this.currentInput.left&&(this.ship.dir=function(t){var s=t.dir;return s>0?s-=5:s=355,s}(this.ship)),this.currentInput.right&&(this.ship.dir=function(t){var s=t.dir;return s<360?s+=5:s=5,s}(this.ship)),this.currentInput.front?this.ship.v=function(t){var s=h({x:.05,y:0},t.dir);return e(t.v,s)}(this.ship):r(this.ship.v)>0&&(this.ship.v=function(t){return{x:t.v.x/1.07,y:t.v.y/1.07}}(this.ship)),this.ship.update(t),this.bullets.forEach((s,i)=>{s.update(t),(s.y<=0||s.y>=700||s.x<=0||s.x>=1200)&&this.bullets.splice(i,1);for(var e=0;e<this.asteroids.length;e++){if(y(s,this.asteroids[e])&&this.asteroids[e].m>50){this.bullets.splice(i,1);var r=l(this.asteroids[e]),h=JSON.parse(JSON.stringify(this.asteroids[e].x)),n=JSON.parse(JSON.stringify(this.asteroids[e].y)),o=JSON.parse(JSON.stringify(this.asteroids[e].m/2)),c=JSON.parse(JSON.stringify(Math.cbrt(Math.pow(this.asteroids[e].r,3)/2))),f=JSON.parse(JSON.stringify(r[0]));console.log(\"old mass\",this.asteroids[e].m),this.asteroids[e].x=h,this.asteroids[e].y=n,this.asteroids[e].m=o,this.asteroids[e].r=c,this.asteroids[e].v=f,console.log(\"newvel\",r[0]),console.log(\"new coor\",this.asteroids[e]);var d=new a(h,n,o,c,JSON.parse(JSON.stringify(r[1])));this.asteroids.push(d),console.log(this.asteroids)}y(s,this.asteroids[e])&&this.asteroids[e].m<=50&&(this.asteroids.splice(e,1),this.boom.play(),0===this.asteroids.length&&(this.level++,this.asteroids=u(5+5*this.level)))}}),this.asteroids.forEach((s,i)=>{s.update(t),p(s,this.ship)&&(this.life--,this.asteroids.splice(i,1),0===this.life&&(this.end=!0),0===this.asteroids.length&&(this.level++,this.asteroids=u(5+5*this.level)));for(var e=0;e<this.asteroids.length;e++)if(s!==this.asteroids[e]&&d(s,this.asteroids[e])){var r=f(s,this.asteroids[e]);s.v=r[0],this.asteroids[e].v=r[1]}})}render(t){this.backBufferCtx.fillStyle=\"black\",this.backBufferCtx.fillRect(0,0,this.WIDTH,this.HEIGHT),this.ship.render(this.backBufferCtx),this.asteroids.forEach(t=>{t.render(this.backBufferCtx)}),this.bullets.forEach(t=>{t.render(this.backBufferCtx)})}loop(t){var s=this._frame_start?t-this._frame_start:0;this.update(s),this.render(s),function(t,s,i){document.getElementById(\"ui\").innerHTML=\"Life: \"+s+\"<br />Level: \"+i+\"<br />Score: \"+t}(this.score,this.life,this.level),this.priorInput=JSON.parse(JSON.stringify(this.currentInput)),this.screenBufferCtx.drawImage(this.backBuffer,0,0),this._frame_start=t,this.end||window.requestAnimationFrame(t=>{this.loop(t)})}}(1200,700);document.getElementById(\"hint\").innerHTML=\"Hint: Use 'A' and 'D' to change direction and use 'W' to speed up. And you can use space bar to fire a laser to destory asteroids.\",window.addEventListener(\"keydown\",function(t){switch(t.key){case\" \":x.currentInput.space=!0;break;case\"ArrowLeft\":case\"a\":x.currentInput.left=!0;break;case\"ArrowRight\":case\"d\":x.currentInput.right=!0;break;case\"ArrowUp\":case\"w\":x.currentInput.front=!0}}),window.addEventListener(\"keyup\",function(t){switch(t.key){case\" \":x.currentInput.space=!1;break;case\"ArrowLeft\":case\"a\":x.currentInput.left=!1;break;case\"ArrowRight\":case\"d\":x.currentInput.right=!1;break;case\"ArrowUp\":case\"w\":x.currentInput.front=!1}}),x.loop()}]);","extractedComments":[]}